ROSLIB.RWTPlot=function(a){this.max_data=a.max_data||100,this.data=[],this.plot=null,this.use_timestamp=a.timestamp},ROSLIB.RWTPlot.prototype.clearData=function(){this.data=[]},ROSLIB.RWTPlot.prototype.initializePlot=function(a,b){var c={min:0,show:!0},d={min:0,max:this.max_data,show:!0},e=_.extend(d,b.xaxis||{}),f=_.extend(c,b.yaxis||{});e.auto_scale&&(this.x_auto_scale=!0,e.min=null,e.max=null),f.auto_scale&&(this.y_auto_scale=!0,f.min=null,f.max=null);var g=_.extend(b,{xaxis:e,yaxis:f});this.plot=$.plot(a,[[[0,200]]],g)},ROSLIB.RWTPlot.prototype.addRawData=function(a){this.data.length>this.max_data&&(this.data=this.data.slice(1));var b=_.isArray(a)?a.length:1;1==b&&(a=[a]),this.data.push(a);for(var c=[],d=0;d<this.data.length;d++)for(var e=0;e<this.data[d].length;e++){var f=this.data[d][e],g=[d,f];c.length<=e&&c.push([]),c[e].push(g)}this.plot&&this.plot.setData(c)},ROSLIB.ROSTimeToSec=function(a){return a.secs+a.nsecs/1e9},ROSLIB.ROSTimeDifference=function(a,b){return a.secs-b.secs+(a.nsecs-b.nsecs)/1e9},ROSLIB.RWTPlot.prototype.addTimestampedData=function(a,b){if(this.data.length>0){for(var c=0,d=0;d<this.data.length;d++){var e=ROSLIB.ROSTimeDifference(a,this.data[d].stamp);if(!(e>this.max_data))break;c+=1}this.data=this.data.slice(c)}var f=_.isArray(b)?b.length:1;1==f&&(b=[b]),b.stamp=a,this.data.push(b);for(var g=[],h=this.data[0].stamp,d=0;d<this.data.length;d++)for(var i=0;i<this.data[d].length;i++){var j=this.data[d][i];if(a!=h){var k=ROSLIB.ROSTimeDifference(this.data[d].stamp,h),l=[k,j];g.length>i||g.push([]),g[i].push(l)}}this.plot&&this.plot.setData(g)},ROSLIB.RWTPlot.prototype.addData=function(a,b){this.use_timestamp?this.addTimestampedData(a,b):this.addRawData(a)},ROSLIB.RWTPlot.prototype.draw=function(){this.plot&&(this.plot.setupGrid(),this.plot.draw())},ROSLIB.Ros.prototype.getTopicType=function(a,b){var c=new ROSLIB.Service({ros:this,name:"/rosapi/topic_type",serviceType:"rosapi/TopicType"}),d=new ROSLIB.ServiceRequest({topic:a});c.callService(d,function(a){b(a.type)})},ROSLIB.Ros.prototype.getMessageDetails=function(a,b){var c=new ROSLIB.Service({ros:this,name:"/rosapi/message_details",serviceType:"rosapi/MessageDetails"}),d=new ROSLIB.ServiceRequest({type:a});c.callService(d,function(a){b(a.typedefs)})},ROSLIB.Ros.prototype.decodeTypeDefs=function(a){a[0];var b=function(a,c){for(var d={},e=0;e<a.fieldnames.length;e++){var f=a.fieldarraylen[e],g=a.fieldnames[e],h=a.fieldtypes[e];if(-1===h.indexOf("/"))d[g]=-1===f?h:[h];else{for(var i=!1,j=0;j<c.length;j++)if(c[j].type.toString()===h.toString()){i=c[j];break}if(!i)throw"cannot find "+h;var k=b(i,c);d[g]=-1===f?k:[k]}}return d};return b(a[0],a)},ROSLIB.Time=function(a){this.nsecs=(a||{}).nsecs||0,this.secs=(a||{}).secs||0},ROSLIB.Time.now=function(){var a=new Date,b=a.getTime();return new ROSLIB.Time({secs:Math.ceil(b/1e3),nsecs:1e6*(b%1e3)})},ROSLIB.Time.prototype.toSec=function(){return this.secs+this.nsecs/1e9},ROSLIB.Time.prototype.substract=function(a){var b=this.secs-a.secs,c=this.nsecs-a.nsecs;return 0>c&&(b-=1,c=1e9+c),new ROSLIB.Time({secs:b,nsecs:c})};